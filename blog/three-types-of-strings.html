<!DOCTYPE html>
<html data-bulma-theme="light">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="icon" href="../img/favicon.ico" sizes="32x32">
  <link rel="icon" href="../img/favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="../img/apple-touch-icon.png">

  <script src="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/js/all.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/fontawesome.min.css"
    rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono:500">

  <link rel="stylesheet" href="../main.css">
  <link rel="stylesheet" href="../css/code.css">
  <link rel="stylesheet" href="../search/docs.css">
  <script src="../main.js"></script>

  <title>There are at least three types of strings</title>
</head>

<body>
  <nav class="bulma-navbar" role="navigation" aria-label="main navigation">
  <div class="bulma-navbar-brand">
    <a class="bulma-navbar-item" href="../">
      <img src="../img/logo.svg" />
    </a>

    <a role="button" class="bulma-navbar-burger" aria-label="menu" aria-expanded="false" data-target="navMenu"
      onClick="handleBurgerClick(this)">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="bulma-navbar-menu" id="navMenu">
    <div class="bulma-navbar-start">

    </div>
    <div class="bulma-navbar-end">
      <div class="bulma-navbar-item"><a class="bulma-button bulma-is-rounded bulma-is-link">Get Started</a></div>
      <div class="bulma-navbar-item"><a class="bulma-button bulma-is-white">Learn</a></div>
      <div class="bulma-navbar-item"><a class="bulma-button bulma-is-white">Community</a></div>
      <div class="bulma-navbar-item"><a class="bulma-button bulma-is-white">Foundation</a></div>
      <div class="bulma-navbar-item"><a class="bulma-button bulma-is-white" href="index.html">Blog</a>
      </div>
      <div class="bulma-navbar-item">
        <a id="search-top-bar" class="bulma-button bulma-is-white" aria-label="Search" onclick="showSearchModal()">
          <span class="bulma-icon bulma-is-small">
            <i class="fas fa-magnifying-glass"></i>
          </span>
        </a>
      </div>
    </div>
  </div>
</nav>

<!-- Search Modal -->
<div id="search-modal" class="bulma-modal bulma-is-justify-content-flex-start bulma-pt-6 bulma-pb-6">
  <div class="bulma-modal-background bulma-is-align-items-flex-start" onclick="hideSearchModal()"></div>
  <div class="bulma-modal-card">
    <header class="bulma-modal-card-head">
      <p class="bulma-control bulma-has-icons-left bulma-is-flex-grow-1">
        <input id="search-input" class="bulma-input bulma-is-medium" type="search" autocomplete="off" oninput="onSearchInput(event)">
        <span class="bulma-icon bulma-is-left">
          <i class="fas fa-magnifying-glass"></i>
        </span>
      </p>
    </header>
    <section id="search-results" class="bulma-modal-card-body">
    </section>
    <footer class="bulma-modal-card-foot bulma-is-justify-content-space-between">
      <span class="bulma-has-text-grey bulma-is-size-7">
        <kbd class="bulma-tag">/</kbd> to open search &nbsp;
        <kbd class="bulma-tag">Esc</kbd> to close
      </span>
    </footer>
  </div>
</div>

  <main>
    
<section class="bulma-hero bulma-is-primary bulma-is-bold">
  <div class="bulma-hero-body bulma-container bulma-is-max-desktop">
    <p class="bulma-title">There are at least three types of strings</p>
    <p class="blog-post-byline bulma-subtitle">
      by
      
        Stephen Compall<span class="delimiter">,</span><span class="last-delimiter"> &</span>
      
      on September 5, 2017
    </p>
     
      <span class="bulma-tag">technical</span>
     
  </div>
</section>
<div class="bulma-section bulma-container bulma-is-max-desktop">
  <div class="blog-post bulma-content">
    <h1 id="there-are-at-least-three-types-of-strings" class="title">There are at least three types of strings</h1>
    <p><a href="https://contributors.scala-lang.org/t/pre-sip-unboxed-wrapper-types/987">Newtype mechanisms</a>
    are a great way to introduce wrapper-free, global distinctions of
    “different” instances of the same type. But we can do that on a local
    level, too,
    <a href="https://gist.github.com/jbgi/d6b677d084fafc641fe01f7ffd00591c/70842ca600e53e8c237c681773fe4e16bd679628#file-label-java-L32">by using type parameters</a>.</p>
    <p>Consider these two signatures.</p>
    <pre><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">mungeIDs</span><span>(</span><span class="identifier">uids</span><span>: </span><span class="type-name">List</span><span>[</span><span class="type-name">String</span><span>], </span><span class="identifier">gids</span><span>: </span><span class="type-name">List</span><span>[</span><span class="type-name">String</span><span>],
             </span><span class="identifier">oids</span><span>: </span><span class="type-name">List</span><span>[</span><span class="type-name">String</span><span>]): </span><span class="type-name">Magic</span><span>[</span><span class="type-name">String</span><span>, </span><span class="type-name">String</span><span>, </span><span class="type-name">String</span><span>]

</span><span class="keyword">def</span><span> </span><span class="declaration-name">mungeIDsSafely</span><span>[</span><span class="type-name">UID</span><span> &lt;: </span><span class="type-name">String</span><span>, </span><span class="type-name">GID</span><span> &lt;: </span><span class="type-name">String</span><span>, </span><span class="type-name">OID</span><span> &lt;: </span><span class="type-name">String</span><span>]
            (</span><span class="identifier">uids</span><span>: </span><span class="type-name">List</span><span>[</span><span class="type-name">UID</span><span>], </span><span class="identifier">gids</span><span>: </span><span class="type-name">List</span><span>[</span><span class="type-name">GID</span><span>],
             </span><span class="identifier">oids</span><span>: </span><span class="type-name">List</span><span>[</span><span class="type-name">OID</span><span>]): </span><span class="type-name">Magic</span><span>[</span><span class="type-name">UID</span><span>, </span><span class="type-name">GID</span><span>, </span><span class="type-name">OID</span><span>] </span></code></pre>
    <p>The second function is a strictly more general interface; the first,
    concrete signature can be implemented by calling the second function,
    passing <code>[String,&nbsp;String,&nbsp;String]</code> as the type arguments. There is no
    need to even have the first signature; anywhere in your program where
    you pass three <code>List[String]</code>s as arguments to <code>mungeIDsSafely</code>, the
    proper type arguments will be inferred.</p>
    <p>Yet, assuming you don’t wish <code>mungeIDs</code> to be oracular (i.e. a source
    of UIDs, GIDs, and OIDs), the second signature is probably much more
    reliable, because type parameters are quite as
    <a href="more-types-than-classes.html#it-must-not-necessarily-be-anything">mysterious</a>
    as the opaque abstract type members of the newtype mechanism.</p>
    <ol class="arabic">
      <li><code>mungeIDsSafely</code> can’t invent new IDs, not even with <code>null</code>.</li>
      <li>It can’t combine them to produce new IDs.</li>
      <li>It <em>can</em> treat the three list arguments as <code>List[String]</code>. However,
      it cannot convert any <code>String</code> back into an ID; any UIDs, GIDs, or
      OIDs that appear in the result <code>Magic[UID,&nbsp;GID,&nbsp;OID]</code> must have
      come from one of the argument lists, directly. (That’s not to say
      that <code>mungeIDsSafely</code> can’t <em>use</em> the string-nature to make that
      decision; for example, it could always choose the
      smallest-as-string UID to put into the resulting <code>Magic</code>. But, that
      UID is <em>still</em> enforced to be a proper element of the <code>uids</code>
      argument, and cannot be gotten from anywhere else.</li>
      <li>Perhaps most importantly, it cannot mix up UIDs, GIDs, and
      OIDs. Even though, “really”, they’re all strings!</li>
    </ol>
    <p>It is entirely irrelevant that you cannot subclass <code>String</code> in Scala,
    Java, or whatever.
    <a href="more-types-than-classes.html">There are more types than classes</a>.</p>
    <p>Given the advantages, it’s very unfortunate that the signature of
    <code>mungeIDsSafely</code> is so much noisier than that of <code>mungeIDs</code>.  At least
    you have the small consolation of eliminating more useless unit tests.</p>
    <p>This is a good first approximation at moving away from the dangers of
    concreteness in Scala, and has the advantage of working in Java, too
    (sort of; the <code>null</code> prohibition is sadly relaxed).</p>
    
    <h2 id="non-supertype-constraints" class="section"><a class="anchor-link" href="#non-supertype-constraints"><code class="fas fa-link fa-sm"></code></a>Non-supertype constraints</h2>
    <p>In Scala, you can also use implicits to devise arbitrary constraints,
    similar to typeclasses in Haskell, and sign your functions using
    implicits instead, for much finer-grained control, improved safety,
    and types-as-documentation.</p>
    <pre><code class="nohighlight"><span class="comment">// a typeclass for &quot;IDish types&quot; (imagine instances)
</span><span class="keyword">sealed</span><span> </span><span class="keyword">trait</span><span> </span><span class="type-name">IDish</span><span>[</span><span class="type-name">A</span><span>]

</span><span class="keyword">def</span><span> </span><span class="declaration-name">mungeIDsTCey</span><span>[</span><span class="type-name">UID</span><span>: </span><span class="type-name">IDish</span><span>, </span><span class="type-name">GID</span><span>: </span><span class="type-name">IDish</span><span>, </span><span class="type-name">OID</span><span>: </span><span class="type-name">IDish</span><span>]
            (</span><span class="identifier">uids</span><span>: </span><span class="type-name">List</span><span>[</span><span class="type-name">UID</span><span>], </span><span class="identifier">gids</span><span>: </span><span class="type-name">List</span><span>[</span><span class="type-name">GID</span><span>],
             </span><span class="identifier">oids</span><span>: </span><span class="type-name">List</span><span>[</span><span class="type-name">OID</span><span>]): </span><span class="type-name">Magic</span><span>[</span><span class="type-name">UID</span><span>, </span><span class="type-name">GID</span><span>, </span><span class="type-name">OID</span><span>] </span></code></pre>
    <p>Though all three types have the same constraint, <code>IDish</code>, they are
    still distinct types.  And now, the coupling with <code>String</code> is broken;
    as the program author, you get to decide whether you want that or not.</p>
    
    <h2 id="pitfalls-avoided-for-you" class="section"><a class="anchor-link" href="#pitfalls-avoided-for-you"><code class="fas fa-link fa-sm"></code></a>Pitfalls avoided for you</h2>
    <p>Luckily, Java doesn’t make the mistake of “reified generics”. If it
    did, you could ask whether <code>UID&nbsp;=&nbsp;GID&nbsp;=&nbsp;OID&nbsp;=&nbsp;String</code>, and all your
    safety guarantees would be gone. Forcing all generics to be reified
    does not grant you any new expressive power; all it does is
    permanently close off large swaths of the spectrum of mystery to you,
    forbidding you from using the full scope of the design space to
    improve the reliability of your well-typed programs.</p>
    <p>The same goes for claiming that <code>null</code> ought to be a default member of
    <em>every</em> type, even the abstract ones that ought to be a little more
    mysterious; it’s easy to add new capabilities (e.g. Scala’s <code>&gt;: Null</code>
    constraint, if you really <em>must</em> use <code>null</code>), but taking them away is
    much, much harder.</p>
    <p>Furthering this spirit of making good programs easier to write and bad
    programs harder to write, a useful area of research in Scala might be
    making signatures such as that of <code>mungeIDsSafely</code> nicer, or
    signatures such as that of <code>mungeIDs</code> uglier.</p>
  </div>
</div>
<div class="bulma-section bulma-container bulma-is-max-desktop">
  <div class="bulma-columns">
    
    <div class="bulma-column">
      <article class="bulma-media">
        
        <figure class="bulma-media-left">
          <p class="bulma-image bulma-is-64x64">
            <img class="bulma-is-rounded" src="https://github.com/S11001001.png" />
          </p>
        </figure>
        
        <div class="bulma-media-content">
          <div class="bulma-content">
            <p>
              <strong>Stephen Compall</strong>
              
            </p>
          </div>
          <nav class="bulma-level">
            <div class="bulma-level-left bulma-is-flex-direction-row">
              
              <a class="bulma-level-item" href="http://github.com/S11001001">
                <span class="bulma-icon bulma-is-small"><i class="fab fa-github"></i></span>
              </a>
              
              
              
              
            </div>
          </nav>
        </div>
      </article>
    </div>
    
  </div>
</div>


  </main>
  <footer class="bulma-footer">
  <div class="bulma-columns">
    <div class="bulma-column">
      Copyright <i class="fab fa-creative-commons"></i> Typelevel Foundation and contributors.
    </div>
    <div class="bulma-column">
      <ul>
        <li><a href="../projects/">Project Index</a></li>
        <li><a href="#">Documentation</a></li>
        <li><a href="#">Contributing</a></li>
      </ul>
    </div>
    <div class="bulma-column">
      <ul>
        <li><a href="../code-of-conduct/">Code of Conduct</a></li>
        <li><a href="../security.html">Security Policy</a></li>
        <li><a href="#">Colophon</a></li>
      </ul>
    </div>
  </div>
  <div class="bulma-has-text-centered">
    <div>Find us on ...</div>
    <div>
      <a class="bulma-icon bulma-is-large bulma-has-text-current" href="https://github.com/typelevel">
        <i class="fab fa-github fa-2x"></i>
      </a>
      <a class="bulma-icon bulma-is-large bulma-has-text-current" href="https://discord.gg/pey2hnSQGS">
        <i class="fab fa-discord fa-2x"></i>
      </a>
      <a class="bulma-icon bulma-is-large bulma-has-text-current" href="https://bsky.app/profile/typelevel.org">
        <i class="fab fa-bluesky fa-2x"></i>
      </a>
      <a class="bulma-icon bulma-is-large bulma-has-text-current" href="https://fosstodon.org/@typelevel">
        <i class="fab fa-mastodon fa-2x"></i>
      </a>
      <a class="bulma-icon bulma-is-large bulma-has-text-current" href="https://www.youtube.com/@typelevel">
        <i class="fab fa-youtube fa-2x"></i>
      </a>
      <a class="bulma-icon bulma-is-large bulma-has-text-current"
        href="https://linkedin.com/company/typelevel-foundation">
        <i class="fab fa-linkedin fa-2x"></i>
      </a>
    </div>
  </div>
</footer>

</body>

</html>

